<!doctype html><html lang=ja><head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1">
<link rel=stylesheet href=/sass/main.min.6e96a703db6986a810b78b787f715c251448097cb1b37a5f2cb675808b29a91d.css>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css integrity=sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB crossorigin=anonymous>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js integrity=sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script defer>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script>
<script defer src=/js/prism.min.js></script>
<link rel=stylesheet href=/css/prism.min.css>
</head>
<body>
<main id=content>
<p class=category>
カテゴリー: <a href=/post>post</a>
</p>
<article class=suuri><p>B 問題のみ書きます。</p>
<h1 id=ドワンゴからの挑戦状-予選-b-fusing-slimes>ドワンゴからの挑戦状 予選 B Fusing Slimes</h1>
<p><strong><a href=https://atcoder.jp/contests/dwacon6th-prelims/tasks/dwacon6th_prelims_b>問題</a></strong></p>
<p>スライムが規則に従い左から右に流れるので、スライムが移動した距離の期待値に$(N-1)!$を掛けたものを求めよ。</p>
<p><strong>解法</strong></p>
<p>こういう問題では、区間に注目するのが典型らしい。(<a href=http://drken1215.hatenablog.com/entry/2020/01/12/014200>けんちょんさんのブログ</a>)<br>
確かに、$O(N)$で解こうと思うと<code>[xi,xi+1)</code>に注目して$O(N)$が妥当な気がする。</p>
<p><code>[xi,xi+1)</code>を通るスライムの数を$c_i$とおく。このとき、<code>i+1</code>の位置にあるスライムより左側の<code>i</code>個のスライムのみ考えればよい。<br>
<code>i</code>の位置にあるスライムが選ばれた場合、選ばれる確率は$\frac{1}{i}$である。この後は$c_{i-1}$個のスライムが通るのと、<code>i</code>の位置にあるスライムが通るのを考えて期待値は$\frac{1}{i} (1 + c_{i-1})$になる。<br>
残りの位置にあるスライムを選ぶと<code>i+1</code>の位置の左側には<code>i-1</code>個のスライムがあることになるので、期待値は$\frac{n-1}{n}c_{i-1}$となる。以上により、$c_i = c_{i-1} + \frac{1}{i}$となり、個数は調和級数になると分かる。<br>
求めるものは、$(N-1)! \times \sum{1\leq i \leq N-1}(x_{i+1} - x_{i}) \times c_i$となる。</p>
<p><strong>実装</strong></p>
<p>区間ごとの足し合わせで計算量は$O(N)$である。MOD での逆数テーブル、factorial テーブルを前計算して持っておけば区間に対し$O(1)$で求まる。<br>
前計算$O(N)$で全体で$O(N)$になる。</p>
<p><strong>コード</strong></p>
<p><a href=https://atcoder.jp/contests/dwacon6th-prelims/submissions/9431284>https://atcoder.jp/contests/dwacon6th-prelims/submissions/9431284</a></p>
<p><strong>感想</strong></p>
<p>競技中は$x_j - x_i$について考えていて、$O(N^2)$の解法が浮かんだのでそこから計算量を落とそうとしていた。区間について考える。覚えておきます。<br>
ModInt ほしい。あと ModInv もほしい。</p>
</article>
<footer>
<p class=license>
This document is licensed under
<a href=https://creativecommons.org/licenses/by/4.0/ target=_blank rel="noopener noreferrer">CC-BY-4.0</a>
</p>
<p class=repository>
<a href=https://github.com/uta8a/discussion/discussions/1 target=_blank rel="noopener noreferrer">discussion</a>にコメントする
</p>
</footer>
</main>
</body>
</html>